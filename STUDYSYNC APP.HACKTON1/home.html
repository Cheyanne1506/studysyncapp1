
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>StudySync AI - Dashboard</title>
<link rel="stylesheet" href="themes.css" />

<style>
* {
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family:inherit;
}

body {
  margin:0;
  background:var(--bg);
  color:var(--text);
}

/* ========== SIDEBAR ========== */
.sidebar {
  width:240px;
  background:var(--sidebar-bg);
  padding:20px;
}

.sidebar h2 { margin-bottom:20px; }

.sidebar ul { list-style:none; }

.nav-link {
  display:block;
  padding:12px;
  border-radius:8px;
  margin-bottom:8px;
  text-decoration:none;
  background:var(--sidebar-item);
  color:var(--text);
}

.nav-link:hover { background:var(--sidebar-hover); }

.nav-link.active {
  background:var(--sidebar-hover);
  box-shadow:0 0 10px rgba(255,0,0,0.4);
}

/* ========== MAIN ========== */
.main {
  flex:1;
  padding:20px;
}

.header {
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:20px;
}

.card {
  background:var(--card-bg);
  padding:20px;
  border-radius:14px;
  margin-bottom:20px;
  box-shadow:0 4px 14px rgba(0,0,0,0.25);
}

input, select {
  width:100%;
  padding:10px;
  margin-top:8px;
  border-radius:8px;
  border:none;
}

button {
  padding:10px;
  border:none;
  border-radius:8px;
  cursor:pointer;
  background:var(--sidebar-hover);
  color:white;
}

/* ========== CALENDAR ========== */
.calendar-header {
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin:12px 0;
}

.calendar-grid {
  display:grid;
  grid-template-columns:repeat(7,1fr);
  gap:8px;
}

.day-name {
  text-align:center;
  font-size:13px;
  opacity:0.8;
}

.calendar-day {
  background:var(--sidebar-item);
  border-radius:10px;
  padding:8px;
  min-height:60px;
  font-size:14px;
}

.calendar-day.empty {
  background:transparent;
}

/* ========== ADD EVENT ========== */
.add-event-grid {
  display:flex;
  flex-direction:column;
  gap:12px;
}

.time-row {
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:10px;
}

.all-day {
  display:flex;
  align-items:center;
  gap:8px;
  font-size:14px;
}

.todo-column {
  display:flex;
  flex-direction:column;
  gap:12px;
}

.todo-input-row { display:flex; gap:8px; margin-top:8px; }

/* Todo list visuals */
#todoList, #doneList { list-style:none; padding:0; margin:8px 0 0 0; display:flex; flex-direction:column; gap:8px; }
.todo-item { display:flex; align-items:center; gap:10px; padding:10px; border-radius:10px; background:rgba(255,255,255,0.02); border-left:4px solid transparent; }
.todo-item .text { flex:1; }
.todo-item:not(.done) { border-left-color: var(--sidebar-hover); background: linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); }
.todo-item.done { border-left-color: rgba(255,255,255,0.14); opacity:0.95; text-decoration:line-through; background: rgba(255,255,255,0.03); }
.todo-item input[type="checkbox"] { width:18px; height:18px; accent-color: var(--sidebar-hover); }

/* Color picker swatches */
.color-picker {
  display:flex;
  flex-wrap:wrap;
  gap:8px;
  margin-top:6px;
}
.swatch {
  width:28px;
  height:28px;
  border-radius:6px;
  border:2px solid transparent;
  cursor:pointer;
  box-shadow:0 2px 6px rgba(0,0,0,0.12);
}
.swatch { position:relative; }
.swatch.selected { outline:3px solid rgba(0,0,0,0.12); transform:translateY(-1px); }
.swatch.selected::after{
  content: '‚úì';
  position:absolute;
  right:6px;
  bottom:3px;
  font-size:14px;
  color:white;
  text-shadow:0 1px 2px rgba(0,0,0,0.6);
}

.calendar-day .event-title {
  margin-top:6px;
  font-size:12px;
  padding:4px 6px;
  border-radius:6px;
  color:var(--text);
  background:rgba(0,0,0,0.18);
}

/* Modal for day events */
.modal {
  position:fixed;
  inset:0;
  display:none;
  align-items:center;
  justify-content:center;
  background:rgba(0,0,0,0.45);
  z-index:300;
}
.modal.show { display:flex; }
.modal-content {
  background:var(--card-bg);
  color:var(--text);
  padding:18px;
  border-radius:12px;
  width:320px;
  max-width:90%;
  box-shadow:0 10px 30px rgba(0,0,0,0.4);
}
.modal-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:8px; }
.modal-list { display:flex; flex-direction:column; gap:8px; max-height:60vh; overflow:auto; }
.modal-item { padding:8px; border-radius:8px; color:var(--text); display:flex; justify-content:space-between; align-items:center; }
.modal-close { background:transparent; border:none; color:var(--text); font-size:18px; cursor:pointer; }

</style>
</head>

<body class="theme-redblack">

<div class="app">

<!-- SIDEBAR -->
<div class="sidebar">
  <h2>StudySync</h2>
  <ul>
    <li><a class="nav-link active" href="home.html">Dashboard</a></li>
    <li><a class="nav-link" href="module.html">Modules</a></li>
    <li><a class="nav-link" href="planner.html">Planner</a></li>
    <li><a class="nav-link" href="study.html">Study Mode</a></li>
    <li><a class="nav-link" href="progress.html">Progress & Goals</a></li>
    <li><a class="nav-link" href="settings.html">Settings</a></li>
  </ul>
</div>

<!-- MAIN -->
<div class="main">



<!-- CALENDAR -->
<div class="card">
  <h3>üìÖ Monthly Calendar</h3>

  <div class="calendar-header">
    <button onclick="prevMonth()">‚óÄ</button>
    <strong id="monthLabel"></strong>
    <button onclick="nextMonth()">‚ñ∂</button>
  </div>

  <div class="calendar-grid" id="calendarGrid"></div>
</div>

<!-- LOWER SECTION -->
<div class="grid">

<!-- ADD EVENT -->
<div class="card">
  <h3>‚ûï Add Event</h3>
  <div class="add-event-grid">
    <input id="eventDate" type="date">
    <div id="timeRow" class="time-row">
      <input id="startTime" type="time">
      <input id="endTime" type="time">
    </div>
    <label class="all-day"><input id="allDay" type="checkbox"> All day</label>
    <input id="eventModule" type="text" placeholder="Subject / Module">
    <select id="eventType">
      <option value="Event">Event</option>
      <option value="Test">Test</option>
      <option value="Assignment">Assignment</option>
      <option value="Exam">Exam</option>
    </select>
    <div id="colorPicker" class="color-picker" aria-label="Event color picker">
      <button class="swatch" data-color="#ff3b30" style="background:#ff3b30"></button>
      <button class="swatch" data-color="#ff9500" style="background:#ff9500"></button>
      <button class="swatch" data-color="#ffcc00" style="background:#ffcc00"></button>
      <button class="swatch" data-color="#34c759" style="background:#34c759"></button>
      <button class="swatch" data-color="#30b0ff" style="background:#30b0ff"></button>
      <button class="swatch" data-color="#5856d6" style="background:#5856d6"></button>
      <button class="swatch" data-color="#ff2d55" style="background:#ff2d55"></button>
      <button class="swatch" data-color="#a2845e" style="background:#a2845e"></button>
      <button class="swatch" data-color="#8e8e93" style="background:#8e8e93"></button>
      <button class="swatch" data-color="#1c1c1e" style="background:#1c1c1e"></button>
      <button class="swatch" data-color="#b388eb" style="background:#b388eb"></button>
      <button class="swatch" data-color="#ff9f9f" style="background:#ff9f9f"></button>
    </div>
    <button id="addEventBtn">Add Event</button>
  </div>
</div>

<!-- TODO -->
<div class="todo-column">
  <div class="card">
    <div style="display:flex;justify-content:space-between;">
      <h3>üìù Work To Do</h3>
      <button id="showTodoInputBtn" style="width:auto;">Ôºã</button>
    </div>
    <div id="todoInputRow" class="todo-input-row" style="display:none;">
      <input id="newTodoInput" placeholder="New task">
      <button id="confirmTodoBtn">Confirm</button>
      <button id="cancelTodoBtn">Cancel</button>
    </div>
    <ul id="todoList"></ul>
  </div>

  <div class="card">
    <h3>‚úÖ Work Done</h3>
    <ul id="doneList"></ul>
  </div>
</div>

  </div>
</div> <!-- close app -->

<!-- Day events modal -->
<div id="eventModal" class="modal" aria-hidden="true">
  <div class="modal-content" role="dialog" aria-modal="true">
    <div class="modal-header">
      <strong id="modalDate">Events</strong>
      <button id="modalClose" class="modal-close">‚úï</button>
    </div>
    <div id="modalList" class="modal-list"></div>
  </div>
</div>


  <script>
let currentDate = new Date();

/* =========================
   MODULE ‚Üí COLOR MAP
========================= */
function getModuleColorMap() {
  const modules = JSON.parse(localStorage.getItem('modules') || '[]');

  const palette = [
    '#ff3b30',
    '#ff9500',
    '#ffcc00',
    '#34c759',
    '#30b0ff',
    '#5856d6',
    '#ff2d55',
    '#8e8e93'
  ];

  const map = {};
  modules.forEach((m, i) => {
    map[m.code] = palette[i % palette.length];
  });

  return map;
}

/* =========================
   FULL CALENDAR TOGGLE
========================= */
function toggleFullCalendar(){
  const c = document.getElementById('fullCalendar');
  c.style.display = c.style.display === 'none' ? 'block' : 'none';
  renderCalendar();
}

/* =========================
   FULL CALENDAR (SYNCED)
========================= */
function renderCalendar(){
  const g = document.getElementById('calendarGrid');
  const l = document.getElementById('monthLabel');
  g.innerHTML = '';

  const y = currentDate.getFullYear();
  const m = currentDate.getMonth();

  l.textContent = currentDate.toLocaleString('default', {
    month: 'long',
    year: 'numeric'
  });

  ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'].forEach(d=>{
    const e = document.createElement('div');
    e.className = 'day-name';
    e.textContent = d;
    g.appendChild(e);
  });

  const firstDay = new Date(y, m, 1).getDay();
  const daysInMonth = new Date(y, m + 1, 0).getDate();
  for(let i=0;i<firstDay;i++) g.appendChild(document.createElement('div'));

  const events = getPlannerCalendarEvents();
  const moduleColors = getModuleColorMap();

  for(let d=1; d<=daysInMonth; d++){
    const cell = document.createElement('div');
    cell.className = 'calendar-day';
    cell.innerHTML = `<strong>${d}</strong>`;

    const iso = `${y}-${String(m+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;

    events.filter(e => e.date === iso).forEach(e => {
      const ev = document.createElement('div');
      ev.className = 'event';
      ev.textContent = e.type
        ? `${e.module} ‚Äì ${e.type}`
        : e.title;

      if (e.moduleCode && moduleColors[e.moduleCode]) {
        ev.style.background = moduleColors[e.moduleCode];
      } else if (e.color) {
        ev.style.background = e.color;
      }

      cell.appendChild(ev);
    });

    g.appendChild(cell);
  }
}

function prevMonth(){
  currentDate.setMonth(currentDate.getMonth() - 1);
  renderCalendar();
}

function nextMonth(){
  currentDate.setMonth(currentDate.getMonth() + 1);
  renderCalendar();
}

/* =========================
   WEEKLY PLANNER
========================= */
function getStartOfWeek(date = new Date()){
  const d = new Date(date);
  const day = d.getDay();
  const diff = d.getDate() - day + (day === 0 ? -6 : 1);
  d.setDate(diff);
  d.setHours(0,0,0,0);
  return d;
}

function renderWeeklyPlanner() {
  const grid = document.getElementById('weekGrid');
  if (!grid) return;

  grid.innerHTML = '';

  const sessions = JSON.parse(localStorage.getItem('studySessions') || '[]');
  const moduleColors = getModuleColorMap();
  const start = getStartOfWeek();

  ['Mon','Tue','Wed','Thu','Fri','Sat','Sun'].forEach((dayName, i) => {
    const date = new Date(start);
    date.setDate(start.getDate() + i);
    const iso = date.toISOString().slice(0, 10);

    const daySessions = sessions.filter(s => s.date === iso);

    const col = document.createElement('div');
    col.className = 'day-col';
    col.innerHTML = `<div class="week-day">${dayName}</div><div class="week-cell"></div>`;

    const cell = col.querySelector('.week-cell');

    if (daySessions.length === 0) {
      cell.innerHTML = `<small style="opacity:.6;">No study</small>`;
    } else {
      daySessions.forEach(s => {
        const baseColor = moduleColors[s.moduleCode] || '#666';
        const topicColor = shadeColor(baseColor, -10);

        const block = document.createElement('div');
        block.style.background = topicColor;
        block.style.borderRadius = '10px';
        block.style.padding = '8px';
        block.style.marginBottom = '6px';
        block.style.color = '#fff';
        block.style.fontSize = '12px';

        block.innerHTML = `
          <strong>${s.moduleCode}</strong><br>
          ${s.topic}<br>
          <small>${s.assessment} ‚Ä¢ ${s.duration} min</small>
        `;

        cell.appendChild(block);
      });
    }

    grid.appendChild(col);
  });
}

/* =========================
   HOME ‚Üí PLANNER SYNC
========================= */
function getPlannerCalendarEvents(){
  const manualEvents = JSON.parse(localStorage.getItem('events') || '[]');
  const assessments = JSON.parse(localStorage.getItem('assessments') || '[]');

  const assessmentEvents = assessments.map(a => ({
    date: a.date,
    module: a.moduleCode,
    moduleCode: a.moduleCode,
    type: a.type,
    allDay: true
  }));

  return [...manualEvents, ...assessmentEvents];
}

/* =========================
   COLOR SHADE
========================= */
function shadeColor(color, percent) {
  let num = parseInt(color.replace('#',''),16),
      amt = Math.round(2.55 * percent),
      R = (num >> 16) + amt,
      G = (num >> 8 & 0x00FF) + amt,
      B = (num & 0x0000FF) + amt;

  return '#' + (
    0x1000000 +
    (R<255?R<1?0:R:255)*0x10000 +
    (G<255?G<1?0:G:255)*0x100 +
    (B<255?B<1?0:B:255)
  ).toString(16).slice(1);
}

/* =========================
   INIT
========================= */
document.addEventListener('DOMContentLoaded', () => {
  renderWeeklyPlanner();
  renderTodos();
});

(function applyPreferences(){
  const theme = localStorage.getItem('theme') || 'theme-redblack';
  const font = localStorage.getItem('font') || 'Arial, sans-serif';
  document.body.className = theme;
  document.body.style.fontFamily = font;
})();
</script>



  



</body>
</html>
